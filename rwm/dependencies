#!/bin/sh

set -e

DWM=(
    xorg-server
    xorg-xinit
    xorg-xsetroot 
    bmenu-x11
    libx11
    libxft
    libxinerama
    feh
    bemenu-x11
    picom
    dunst
    xclip 
    lxappearance
    libinput-gestures
    xdotool
)

install_package_group() {
    local group_name="$1"
    shift
    local packages=("$@")
    echo -e "\n${BLUE}Installing ${group_name}...${NC}"

    if command -v paru >/dev/null 2>&1; then
        if paru -S --needed --noconfirm "${packages[@]}"; then
            echo "✔️  ${group_name} installed successfully"
            return 0
        fi
    elif command -v yay >/dev/null 2>&1; then
        if yay -S --needed --noconfirm "${packages[@]}"; then
            echo "✔️  ${group_name} installed successfully"
            return 0
        fi
    elif command -v pacman >/dev/null 2>&1; then
        if sudo pacman -S --needed --noconfirm "${packages[@]}"; then
            echo "✔️  ${group_name} installed successfully"
            return 0
        fi
    else
        echo "❌  No supported AUR or pacman helper found"
        return 1
    fi

    echo "❌  Failed to install ${group_name}"
    return 1
}

install_package_group "DWM Packages" "${DWM[@]}"

echo "Setting up inputs to be available for your user"
sudo gpasswd -a $USER input
echo "Setting up inputs Done"

echo "Setting up DWM completed"
